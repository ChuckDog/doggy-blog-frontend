import { BlogPost, Category, Tag } from "@/types/blog";

// æ¨¡æ‹Ÿåšå®¢æ•°æ®
export const blogPosts: BlogPost[] = [
  {
    id: "1",
    title: "æˆ‘çš„ç¬¬ä¸€åªé‡‘æ¯›çŠ¬",
    excerpt: "åˆ†äº«æˆ‘ä¸Žé‡‘æ¯›çŠ¬å°ç™½çš„ç¾Žå¥½æ—¶å…‰ï¼Œä»Žåˆæ¬¡è§é¢åˆ°æˆä¸ºæœ€å¥½çš„æœ‹å‹ã€‚",
    content: `
      ## æˆ‘çš„ç¬¬ä¸€åªé‡‘æ¯›çŠ¬
      
      åŽ»å¹´æ˜¥å¤©ï¼Œæˆ‘åœ¨å® ç‰©åº—ç¬¬ä¸€æ¬¡è§åˆ°äº†å°ç™½ã€‚å®ƒæœ‰ç€é‡‘è‰²çš„æ¯›å‘å’Œæ¸©æŸ”çš„çœ¼ç¥žï¼Œ
      ä¸€ä¸‹å­å°±ä¿˜èŽ·äº†æˆ‘çš„å¿ƒã€‚
      
      ### åˆæ¬¡ç›¸é‡
      
      é‚£å¤©æ˜¯å‘¨æœ«ï¼Œæˆ‘å’Œæœ‹å‹ä¸€èµ·åŽ»å® ç‰©åº—é€›è¡—ã€‚åˆšè¿›é—¨å°±çœ‹åˆ°ä¸€åªå°é‡‘æ¯›åœ¨ç¬¼å­é‡Œï¼Œ
      å®ƒæ­£ç”¨é‚£åŒæ°´æ±ªæ±ªçš„å¤§çœ¼ç›çœ‹ç€æˆ‘ä»¬ã€‚æˆ‘è¹²ä¸‹æ¥å’Œå®ƒå¯¹è§†ï¼Œå®ƒç«Ÿç„¶ä¸»åŠ¨æŠŠçˆªå­ä¼¸å‘æˆ‘ã€‚
      
      ### æˆé•¿åŽ†ç¨‹
      
      å¸¦å›žå®¶åŽï¼Œå°ç™½å¾ˆå¿«å°±é€‚åº”äº†æ–°çŽ¯å¢ƒã€‚å®ƒç‰¹åˆ«èªæ˜Žï¼Œä¸‰ä¸ªæœˆå°±èƒ½å­¦ä¼šåŸºæœ¬æŒ‡ä»¤ã€‚
      æœ€è®©æˆ‘æ„ŸåŠ¨çš„æ˜¯å®ƒçš„å¿ è¯šï¼Œæ— è®ºæˆ‘å¤šæ™šå›žå®¶ï¼Œå®ƒéƒ½ä¼šåœ¨é—¨å£ç­‰æˆ‘ã€‚
      
      ### æ—¥å¸¸è¶£äº‹
      
      å°ç™½æœ‰ä¸ªç‰¹åˆ«çš„ä¹ æƒ¯ï¼Œæ¯å¤©æ—©ä¸Šéƒ½è¦åœ¨æˆ‘çš„åºŠè¾¹"å«é†’"æˆ‘ã€‚å®ƒä¼šè½»è½»åœ°æŠŠé¼»å­å‡‘åˆ°æˆ‘è„¸ä¸Šï¼Œ
      ç„¶åŽå‘å‡ºæ¸©æŸ”çš„å“¼å£°ã€‚è¿™ç§è‡ªç„¶çš„é—¹é’Ÿæ¯”ä»»ä½•ç”µå­è®¾å¤‡éƒ½æœ‰æ•ˆï¼
      
      çŽ°åœ¨å°ç™½å·²ç»ä¸€å²å¤šäº†ï¼Œä¾ç„¶æ˜¯æˆ‘æœ€å¿ å®žçš„ä¼™ä¼´ã€‚æœ‰æ—¶å€™æˆ‘æƒ³ï¼Œä¹Ÿè®¸ä¸æ˜¯æˆ‘æ”¶å…»äº†å®ƒï¼Œ
      è€Œæ˜¯å®ƒé€‰æ‹©äº†æˆ‘ä½œä¸ºå®ƒçš„äººç±»æœ‹å‹ã€‚
    `,
    author: "çˆ±ç‹—äººå£«å°çŽ‹",
    date: "2024-01-15",
    category: "ç”Ÿæ´»åˆ†äº«",
    tags: ["é‡‘æ¯›çŠ¬", "å® ç‰©æ•…äº‹", "æ—¥å¸¸"],
    imageUrl: "",
    readTime: 5,
  },
  {
    id: "2",
    title: "ç‹—ç‹—è®­ç»ƒå¿ƒå¾—åˆ†äº«",
    excerpt: "ä¸‰å¹´å…»ç‹—ç»éªŒæ€»ç»“ï¼Œæ•™ä½ å¦‚ä½•æ­£ç¡®è®­ç»ƒä½ çš„æ¯›å­©å­ã€‚",
    content: `
      ## ç‹—ç‹—è®­ç»ƒå¿ƒå¾—åˆ†äº«
      
      å…»ç‹—ä¸‰å¹´ï¼Œæˆ‘æ€»ç»“äº†ä¸€äº›å®žç”¨çš„è®­ç»ƒæ–¹æ³•ï¼Œå¸Œæœ›èƒ½å¸®åŠ©æ›´å¤šç‹—ä¸»äººã€‚
      
      ### åŸºç¡€è®­ç»ƒåŽŸåˆ™
      
      1. **ä¸€è‡´æ€§æœ€é‡è¦**
         - æ‰€æœ‰å®¶åº­æˆå‘˜è¦ä½¿ç”¨ç›¸åŒçš„æŒ‡ä»¤
         - è®­ç»ƒæ—¶é—´å’Œåœ°ç‚¹è¦å›ºå®š
         - å¥–æƒ©æ ‡å‡†è¦æ˜Žç¡®
      
      2. **æ­£é¢å¼ºåŒ–**
         - ç”¨é›¶é£Ÿå’Œè¡¨æ‰¬å¥–åŠ±æ­£ç¡®è¡Œä¸º
         - é¿å…ä½“ç½šï¼Œä¼šé€ æˆææƒ§å¿ƒç†
         - è€å¿ƒç­‰å¾…ï¼Œç»™ç‹—ç‹—æ€è€ƒæ—¶é—´
      
      3. **å¾ªåºæ¸è¿›**
         - ä»Žç®€å•æŒ‡ä»¤å¼€å§‹ï¼ˆåä¸‹ã€æ¡æ‰‹ï¼‰
         - é€æ­¥å¢žåŠ éš¾åº¦
         - æ¯æ¬¡è®­ç»ƒä¸è¶…è¿‡15åˆ†é’Ÿ
      
      ### å¸¸è§é—®é¢˜è§£å†³
      
      **ä¹±å«é—®é¢˜ï¼š**
      - æ‰¾å‡ºå«å£°çš„åŽŸå› ï¼ˆé¥¥é¥¿ã€æ— èŠã€è­¦æˆ’ï¼‰
      - é’ˆå¯¹æ€§åœ°è§£å†³é—®é¢˜
      - æ•™ä¼š"å®‰é™"æŒ‡ä»¤
      
      **éšåœ°å¤§å°ä¾¿ï¼š**
      - å»ºç«‹å›ºå®šçš„å¤–å‡ºæ—¶é—´
      - ä¾¿åŽåŠæ—¶å¥–åŠ±
      - è€å¿ƒå¼•å¯¼ï¼Œä¸è¦æ€¥èº
      
      ### æˆ‘çš„ç»éªŒ
      
      è®°ä½ï¼Œæ¯åªç‹—ç‹—éƒ½æœ‰è‡ªå·±çš„æ€§æ ¼ç‰¹ç‚¹ã€‚æœ‰çš„æ´»æ³¼å¥½åŠ¨ï¼Œæœ‰çš„å®‰é™å†…å‘ã€‚
      ä½œä¸ºä¸»äººï¼Œæˆ‘ä»¬è¦åšçš„ä¸æ˜¯æ”¹å˜å®ƒä»¬çš„å¤©æ€§ï¼Œè€Œæ˜¯å¼•å¯¼å®ƒä»¬å‘æŒ¥æœ€å¥½çš„ä¸€é¢ã€‚
    `,
    author: "è®­çŠ¬å¸ˆæŽæ˜Ž",
    date: "2024-01-20",
    category: "è®­ç»ƒæŒ‡å—",
    tags: ["è®­ç»ƒæŠ€å·§", "è¡Œä¸ºçŸ«æ­£", "æ–°æ‰‹å¿…è¯»"],
    readTime: 8,
  },
  {
    id: "3",
    title: "ç‹—ç‹—è¥å…»é£Ÿè°±æŽ¨è",
    excerpt: "ä¸ºä½ çš„æ¯›å­©å­åˆ¶å®šç§‘å­¦çš„é¥®é£Ÿè®¡åˆ’ï¼Œè®©å®ƒä»¬å¥åº·æˆé•¿ã€‚",
    content: `
      ## ç‹—ç‹—è¥å…»é£Ÿè°±æŽ¨è
      
      åˆç†çš„é¥®é£Ÿæ˜¯ç‹—ç‹—å¥åº·çš„åŸºç¡€ï¼Œä»Šå¤©åˆ†äº«ä¸€äº›æˆ‘å®¶ç‹—ç‹—çš„é£Ÿè°±ã€‚
      
      ### è¥å…»éœ€æ±‚åˆ†æž
      
      ä¸åŒå¹´é¾„å’Œä½“åž‹çš„ç‹—ç‹—è¥å…»éœ€æ±‚ä¸åŒï¼š
      
      **å¹¼çŠ¬æœŸï¼ˆ0-12ä¸ªæœˆï¼‰ï¼š**
      - éœ€è¦é«˜è›‹ç™½æ”¯æŒç”Ÿé•¿å‘è‚²
      - é’™è´¨è¡¥å……ä¿ƒè¿›éª¨éª¼å¥åº·
      - å°‘é‡å¤šé¤ï¼Œä¸€å¤©3-4æ¬¡
      
      **æˆçŠ¬æœŸï¼ˆ1-7å²ï¼‰ï¼š**
      - ç»´æŒä½“é‡ï¼Œé¿å…è‚¥èƒ–
      - å‡è¡¡è¥å…»ï¼Œå¢žå¼ºå…ç–«åŠ›
      - ä¸€å¤©2é¤å³å¯
      
      **è€å¹´çŠ¬ï¼ˆ7å²ä»¥ä¸Šï¼‰ï¼š**
      - æ˜“æ¶ˆåŒ–çš„é£Ÿç‰©
      - å…³èŠ‚ä¿æŠ¤æˆåˆ†
      - æŽ§åˆ¶çƒ­é‡æ‘„å…¥
      
      ### æŽ¨èé£Ÿè°±
      
      **é¸¡è‚‰è”¬èœé¥­ï¼š**
      - é¸¡èƒ¸è‚‰200gï¼ˆç…®ç†Ÿåˆ‡ä¸ï¼‰
      - èƒ¡èåœ1æ ¹ï¼ˆè’¸ç†Ÿåˆ‡ç¢Žï¼‰
      - è¥¿å…°èŠ±100gï¼ˆç„¯æ°´ï¼‰
      - ç±³é¥­1ç¢—
      - æ©„æ¦„æ²¹1å‹º
      
      **ä¸‰æ–‡é±¼ç‡•éº¦ç²¥ï¼š**
      - ä¸‰æ–‡é±¼150gï¼ˆåŽ»éª¨è’¸ç†Ÿï¼‰
      - ç‡•éº¦ç‰‡50g
      - å—ç“œ100gï¼ˆè’¸ç†ŸåŽ‹æ³¥ï¼‰
      - å°‘è®¸è èœå¶
      
      ### æ³¨æ„äº‹é¡¹
      
      âŒ ä¸è¦å–‚é£Ÿï¼šå·§å…‹åŠ›ã€æ´‹è‘±ã€è‘¡è„ã€æœ¨ç³–é†‡
      âœ… å¯ä»¥é€‚é‡ï¼šè‹¹æžœã€èƒ¡èåœã€é…¸å¥¶ã€é¸¡è›‹
      ðŸ’¡ å»ºè®®å’¨è¯¢å…½åŒ»åˆ¶å®šä¸ªæ€§åŒ–é£Ÿè°±
    `,
    author: "å® ç‰©è¥å…»å¸ˆå¼ åŒ»ç”Ÿ",
    date: "2024-01-25",
    category: "å¥åº·é¥®é£Ÿ",
    tags: ["è¥å…»æ­é…", "è‡ªåˆ¶ç‹—ç²®", "å¥åº·ç®¡ç†"],
    readTime: 6,
  },
  {
    id: "4",
    title: "å¸¦ç‹—ç‹—æ—…è¡Œçš„æ³¨æ„äº‹é¡¹",
    excerpt: "æƒ³è¦å¸¦ç€æ¯›å­©å­åŽ»çœ‹ä¸–ç•Œï¼Ÿè¿™äº›å‡†å¤‡äº‹é¡¹ä½ å¿…é¡»çŸ¥é“ï¼",
    content: `
      ## å¸¦ç‹—ç‹—æ—…è¡Œçš„æ³¨æ„äº‹é¡¹
      
      ç‹—ç‹—ä¹Ÿæ˜¯å®¶åº­æˆå‘˜ï¼Œå½“ç„¶è¦ä¸€èµ·äº«å—æ—…è¡Œçš„ä¹è¶£ï¼
      
      ### å‡ºè¡Œå‰å‡†å¤‡
      
      **è¯ä»¶æ£€æŸ¥ï¼š**
      - ç‹—ç‹—èº«ä»½è¯/èŠ¯ç‰‡
      - ç–«è‹—æŽ¥ç§è¯æ˜Ž
      - å¥åº·ä½“æ£€æŠ¥å‘Š
      
      **è£…å¤‡æ¸…å•ï¼š**
      - ä¾¿æºå¼æ°´ç›†å’Œå……è¶³é¥®æ°´
      - ç‹—ç²®å’Œé›¶é£Ÿ
      - ç‰µå¼•ç»³å’Œé¡¹åœˆ
      - ä¾¿ä¾¿è¢‹
      - å¸¸ç”¨è¯å“
      
      ### äº¤é€šå·¥å…·é€‰æ‹©
      
      **é£žæœºå‡ºè¡Œï¼š**
      - æå‰äº†è§£èˆªç©ºå…¬å¸è§„å®š
      - é€‰æ‹©åˆé€‚çš„èˆªç©ºç®±
      - é¿å…æ‰˜è¿ï¼Œå°½é‡éšèº«æºå¸¦
      
      **è‡ªé©¾æ¸¸ï¼š**
      - å‡†å¤‡è½¦è½½ç‹—ç¬¼æˆ–å®‰å…¨å¸¦
      - å®šæ—¶åœè½¦ä¼‘æ¯
      - æ³¨æ„è½¦å†…æ¸©åº¦è°ƒèŠ‚
      
      ### ä½å®¿å®‰æŽ’
      
      æŽ¨èé€‰æ‹©ï¼š
      - å…è®¸å® ç‰©å…¥ä½çš„é…’åº—
      - æ°‘å®¿æˆ–åº¦å‡æ‘
      - éœ²è¥åŸºåœ°
      
      é¢„è®¢æ—¶ä¸€å®šè¦ç¡®è®¤ï¼š
      - æ˜¯å¦æ”¶å–é¢å¤–è´¹ç”¨
      - å¯¹ç‹—ç‹—ä½“åž‹çš„é™åˆ¶
      - å‘¨è¾¹æ˜¯å¦æœ‰é›ç‹—åœºæ‰€
      
      ### æˆ‘çš„æ—…è¡Œç»éªŒ
      
      åŽ»å¹´å¤å¤©å¸¦æˆ‘å®¶æŸ¯åŸºåŽ»äº†æµ·è¾¹ï¼Œé‚£æ˜¯æˆ‘ä»¬æœ€éš¾å¿˜çš„ä¸€æ¬¡æ—…è¡Œã€‚
      çœ‹ç€å®ƒåœ¨æ²™æ»©ä¸Šå¥”è·‘ï¼Œåœ¨æµ·æµªä¸­å¬‰æˆï¼Œæˆ‘è§‰å¾—æ‰€æœ‰çš„å‡†å¤‡å·¥ä½œéƒ½æ˜¯å€¼å¾—çš„ã€‚
      
      è®°ä½ï¼Œå®‰å…¨æ°¸è¿œæ˜¯ç¬¬ä¸€ä½çš„ã€‚å¦‚æžœç‹—ç‹—è¡¨çŽ°å‡ºç´§å¼ æˆ–ä¸é€‚ï¼Œ
      è¦åŠæ—¶è°ƒæ•´è¡Œç¨‹æˆ–å¯»æ±‚ä¸“ä¸šå¸®åŠ©ã€‚
    `,
    author: "æ—…è¡Œåšä¸»å°ç¾Ž",
    date: "2024-02-01",
    category: "ç”Ÿæ´»åˆ†äº«",
    tags: ["æ—…è¡Œæ”»ç•¥", "æˆ·å¤–æ´»åŠ¨", "ç»éªŒåˆ†äº«"],
    readTime: 7,
  },
];

// èŽ·å–æ‰€æœ‰åˆ†ç±»
export const getCategories = (): Category[] => {
  const categoryMap = new Map<string, number>();

  blogPosts.forEach((post) => {
    const count = categoryMap.get(post.category) || 0;
    categoryMap.set(post.category, count + 1);
  });

  return Array.from(categoryMap.entries()).map(([name, count]) => ({
    id: name.toLowerCase().replace(/\s+/g, "-"),
    name,
    count,
  }));
};

// èŽ·å–æ‰€æœ‰æ ‡ç­¾
export const getTags = (): Tag[] => {
  const tagMap = new Map<string, number>();

  blogPosts.forEach((post) => {
    post.tags.forEach((tag) => {
      const count = tagMap.get(tag) || 0;
      tagMap.set(tag, count + 1);
    });
  });

  return Array.from(tagMap.entries()).map(([name, count]) => ({
    id: name.toLowerCase().replace(/\s+/g, "-"),
    name,
    count,
  }));
};

// æ ¹æ®IDèŽ·å–å•ç¯‡æ–‡ç« 
export const getPostById = (id: string): BlogPost | undefined => {
  return blogPosts.find((post) => post.id === id);
};

// æ ¹æ®åˆ†ç±»èŽ·å–æ–‡ç« 
export const getPostsByCategory = (category: string): BlogPost[] => {
  return blogPosts.filter((post) => post.category === category);
};

// æ ¹æ®æ ‡ç­¾èŽ·å–æ–‡ç« 
export const getPostsByTag = (tag: string): BlogPost[] => {
  return blogPosts.filter((post) => post.tags.includes(tag));
};

// æœç´¢æ–‡ç« 
export const searchPosts = (keyword: string): BlogPost[] => {
  const lowerKeyword = keyword.toLowerCase();
  return blogPosts.filter(
    (post) =>
      post.title.toLowerCase().includes(lowerKeyword) ||
      post.excerpt.toLowerCase().includes(lowerKeyword) ||
      post.content.toLowerCase().includes(lowerKeyword) ||
      post.tags.some((tag) => tag.toLowerCase().includes(lowerKeyword)),
  );
};

// èŽ·å–æœ€æ–°æ–‡ç« 
export const getLatestPosts = (limit: number = 3): BlogPost[] => {
  return [...blogPosts]
    .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
    .slice(0, limit);
};

// èŽ·å–çƒ­é—¨æ–‡ç« ï¼ˆæŒ‰æ ‡ç­¾æ•°é‡æŽ’åºï¼‰
export const getPopularPosts = (limit: number = 3): BlogPost[] => {
  return [...blogPosts]
    .sort((a, b) => b.tags.length - a.tags.length)
    .slice(0, limit);
};

// èŽ·å–ç›¸å…³æ–‡ç« ï¼ˆç›¸åŒåˆ†ç±»æˆ–æ ‡ç­¾ï¼‰
export const getRelatedPosts = (
  currentPostId: string,
  limit: number = 3,
): BlogPost[] => {
  const currentPost = getPostById(currentPostId);
  if (!currentPost) return [];

  const relatedPosts = blogPosts.filter(
    (post) =>
      post.id !== currentPostId &&
      (post.category === currentPost.category ||
        post.tags.some((tag) => currentPost.tags.includes(tag))),
  );

  return relatedPosts.slice(0, limit);
};

// æ ¼å¼åŒ–æ—¥æœŸ
export const formatDate = (dateString: string): string => {
  return new Date(dateString).toLocaleDateString("zh-CN", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};

// è®¡ç®—é˜…è¯»æ—¶é—´
export const calculateReadTime = (content: string): number => {
  const wordsPerMinute = 200;
  const wordCount = content.replace(/<[^>]*>/g, "").length;
  return Math.ceil(wordCount / wordsPerMinute);
};
